<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="app.diagrams.net" modified="2026-02-16T00:00:00.000Z" agent="draw.io" etag="" version="20.4.3" type="device">
  <diagram id="arch-1" name="Architecture">
    <mxGraphModel dx="1002" dy="618" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- Client (React) -->
        <mxCell id="2" value="Client\n(Vite + React)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#D5E8D4;strokeColor=#82B366;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="40" y="60" width="180" height="80" as="geometry"/>
        </mxCell>

        <!-- Server (Express) -->
        <mxCell id="3" value="Server\n(Express)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE6CC;strokeColor=#D79B00;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="300" y="60" width="220" height="100" as="geometry"/>
        </mxCell>

        <!-- Local Docs -->
        <mxCell id="4" value="Local Docs\nserver/local_docs/" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#7F8C8D;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="560" y="20" width="200" height="60" as="geometry"/>
        </mxCell>

        <!-- Preprocessor -->
        <mxCell id="5" value="Preprocessor\n(preprocessUploads)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1D5E7;strokeColor=#9673A6;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="300" y="190" width="220" height="80" as="geometry"/>
        </mxCell>

        <!-- Embeddings Service (OpenAI) -->
        <mxCell id="6" value="Embeddings\n(OpenAI API)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#DAE8FC;strokeColor=#6C8EBF;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="300" y="320" width="200" height="70" as="geometry"/>
        </mxCell>

        <!-- Docs store -->
        <mxCell id="7" value="Docs Store\ndocs.json (id, text, embedding, topic, provider)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF2CC;strokeColor=#D6B656;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="560" y="120" width="220" height="100" as="geometry"/>
        </mxCell>

        <!-- Retrieval -->
        <mxCell id="8" value="Retrieval\nretrieveContext()" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F8CECC;strokeColor=#B85450;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="300" y="430" width="220" height="70" as="geometry"/>
        </mxCell>

        <!-- Chat Endpoint / LLM -->
        <mxCell id="9" value="Chat Endpoint\n/api/chat â†’ proxy to LLMs" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#D5E8D4;strokeColor=#6AA84F;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="40" y="190" width="220" height="90" as="geometry"/>
        </mxCell>

        <!-- Connectors -->
        <mxCell id="e1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#000000;" edge="1" parent="1" source="2" target="3">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#555555;" edge="1" parent="1" source="3" target="4">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#000000;" edge="1" parent="1" source="5" target="6">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#000000;" edge="1" parent="1" source="5" target="7">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#000000;" edge="1" parent="1" source="3" target="8">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#000000;" edge="1" parent="1" source="8" target="6">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#000000;" edge="1" parent="1" source="3" target="7">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="e8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#000000;" edge="1" parent="1" source="9" target="3">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- Notes -->
        <mxCell id="n1" value="Notes:\n- Topics: forensics, designer_genes\n- Preprocess computes embeddings and stores them per-provider\n- Retrieval prefers same-provider embeddings, falls back to keyword search" style="text;html=1;align=left;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="40" y="340" width="220" height="180" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
